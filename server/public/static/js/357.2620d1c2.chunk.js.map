{"version":3,"file":"static/js/357.2620d1c2.chunk.js","mappings":"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","sources":["pages/Agent.jsx","utils/http.js","utils/api.js"],"sourcesContent":["import { Table, Button, Form, Input, Drawer, Select } from 'antd';\nimport { UserOutlined } from '@ant-design/icons';\nimport { useEffect, useState } from 'react';\nimport { AgentApi, AgentAddApi, AgentEditApi, AgentDelApi } from 'utils/api';\n\nconst { Column } = Table;\n\nconst Agent = () => {\n  const [form] = Form.useForm();\n  const [editForm] = Form.useForm();\n  const [visible, setVisible] = useState(false);\n  const [dataSource, setDataSource] = useState();\n  const [urlsSource, setUrlsSource] = useState();\n\n  useEffect(() => {\n    init();\n  }, []);\n\n  const init = () => {\n    AgentApi().then((res) => {\n      let arr = [];\n      let urlsArr = [];\n      res.data.data.forEach((element) => {\n        arr.push({\n          ...element,\n          key: element._id,\n          nick: element.url.nick,\n          url: element.url._id,\n          downurl:\n            'http://' + window.location.host + '/#/download/' + element._id,\n          createTime: new Date(element.createTime).toLocaleString(),\n        });\n      });\n      res.data.urls.forEach((element) => {\n        urlsArr.push({\n          ...element,\n          key: element._id,\n          label: element.nick,\n          value: element._id,\n        });\n      });\n      setUrlsSource(urlsArr);\n      setDataSource(arr);\n    });\n  };\n  const onAdd = (values) => {\n    AgentAddApi(values).then((res) => {\n      form.resetFields();\n      init();\n    });\n  };\n\n  const onEdit = (text) => {\n    editForm.setFieldsValue(text);\n    setVisible(true);\n  };\n\n  const onDel = (key) => {\n    const params = { id: key };\n    AgentDelApi(params).then(() => {\n      const newDataSource = dataSource.filter((item) => item.key !== key);\n      setDataSource(newDataSource);\n    });\n  };\n\n  const onClose = () => {\n    editForm.resetFields();\n    setVisible(false);\n  };\n  const onFinish = (values) => {\n    AgentEditApi(values).then((res) => {\n      init();\n      editForm.resetFields();\n      setVisible(false);\n    });\n  };\n  return (\n    <div>\n      <Form\n        form={form}\n        name=\"horizontal_login\"\n        layout=\"inline\"\n        onFinish={onAdd}\n      >\n        <Form.Item\n          name=\"name\"\n          rules={[{ required: true, message: '请输入代理名称!' }]}\n        >\n          <Input prefix={<UserOutlined />} placeholder=\"代理名称\" />\n        </Form.Item>\n        <Form.Item\n          name=\"url\"\n          style={{ width: '600px' }}\n          rules={[{ required: true, message: '请选择代理的跳转链接!' }]}\n        >\n          <Select options={urlsSource} placeholder=\"跳转链接\" />\n        </Form.Item>\n        <Form.Item shouldUpdate>\n          {() => (\n            <Button\n              type=\"primary\"\n              htmlType=\"submit\"\n              disabled={\n                !form.isFieldsTouched(true) ||\n                !!form.getFieldsError().filter(({ errors }) => errors.length)\n                  .length\n              }\n            >\n              添加\n            </Button>\n          )}\n        </Form.Item>\n      </Form>\n      <Table dataSource={dataSource}>\n        <Column title=\"昵称\" dataIndex=\"name\" key=\"name\" />\n        <Column title=\"链接标识\" dataIndex=\"nick\" key=\"nick\" />\n        <Column title=\"下载地址\" dataIndex=\"downurl\" key=\"downurl\" />\n        <Column title=\"时间\" dataIndex=\"createTime\" key=\"createTime\" />\n        <Column\n          title=\"操作\"\n          key=\"action\"\n          align=\"right\"\n          render={(_, text) => (\n            <div>\n              <Button\n                type=\"primary\"\n                style={{ marginRight: '3px' }}\n                onClick={() => onEdit(text)}\n              >\n                编辑\n              </Button>\n              <Button type=\"primary\" danger onClick={() => onDel(text.key)}>\n                删除\n              </Button>\n            </div>\n          )}\n        />\n      </Table>\n      <Drawer\n        title=\"编辑代理\"\n        placement=\"right\"\n        onClose={onClose}\n        visible={visible}\n      >\n        <Form form={editForm} name=\"horizontal_login\" onFinish={onFinish}>\n          <Form.Item style={{ display: 'none' }} name=\"_id\">\n            <Input disabled />\n          </Form.Item>\n          <Form.Item\n            name=\"name\"\n            rules={[{ required: true, message: '请输入代理名称!' }]}\n          >\n            <Input prefix={<UserOutlined />} placeholder=\"代理名称\" />\n          </Form.Item>\n          <Form.Item\n            name=\"url\"\n            rules={[{ required: true, message: '请选择代理的跳转链接!' }]}\n          >\n            <Select options={urlsSource} placeholder=\"跳转链接\" />\n          </Form.Item>\n          <Form.Item shouldUpdate>\n            {() => (\n              <Button type=\"primary\" htmlType=\"submit\">\n                修改\n              </Button>\n            )}\n          </Form.Item>\n        </Form>\n      </Drawer>\n    </div>\n  );\n};\n\nexport default Agent;\n","import axios from 'axios';\nimport { message } from 'antd';\n\nconst http = axios.create({\n  baseURL: process.env.REACT_APP_SERVER_PORT,\n});\n\nhttp.interceptors.request.use(\n  (config) => {\n    if (localStorage.__web_token) {\n      config.headers.Authorization = 'Bearer ' + localStorage.__web_token;\n    }\n    return config;\n  },\n  (err) => {\n    return Promise.reject(err);\n  }\n);\n\nhttp.interceptors.response.use(\n  (res) => {\n    if (res.data.message) {\n      message.success(res.data.message);\n    }\n    return res;\n  },\n  (err) => {\n    if (err.response.status === 401) {\n      localStorage.removeItem('__web_token');\n      console.log(window.location.pathname.indexOf('login'));\n\n      if (window.location.pathname.indexOf('login') === -1) {\n        window.location.pathname = '/login';\n      }\n    }\n    if (err.response.data) {\n      message.error(err.response.data);\n      return Promise.reject(err);\n    }\n    return Promise.reject(err);\n  }\n);\n\nexport default http;\n","import http from './http';\n\nexport const LoginApi = (model) => http.post('/login', model);\n\nexport const RegisterApi = (model) => http.post('/register', model);\n\nexport const UserApi = () => http.get('/user');\n\nexport const UserEditApi = (model) => http.put('/user', model);\n\nexport const UrlApi = () => http.get('/url');\n\nexport const UrlAddApi = (model) => http.post('/url', model);\n\nexport const UrlEditApi = (model) => http.put('/url', model);\n\nexport const UrlDelApi = (params) => http.delete('/url', { params });\n\nexport const AgentApi = () => http.get('/agent');\n\nexport const AgentAddApi = (model) => http.post('/agent', model);\n\nexport const AgentEditApi = (model) => http.put('/agent', model);\n\nexport const AgentDelApi = (params) => http.delete('/agent', { params });\n\nexport const PromotionApi = () => http.get('/promotion');\n\nexport const PromotionEditApi = (model) => http.post('/promotion', model);\n\nexport const StatsApi = (model) => http.put('/stats', model);\n\nexport const StatsSearchApi = (model) => http.post('/stats', model);\n\nexport const HomeApi = () => http.get('/stats');\n\nexport const CommonImgApi = (model) => http.put('/common', model);\n\nexport const CommonDataApi = (model) => http.post('/common', model);\n"],"names":["Column","Table","Form","form","editForm","useState","visible","setVisible","dataSource","setDataSource","urlsSource","setUrlsSource","useEffect","init","AgentApi","then","res","arr","urlsArr","data","forEach","element","push","key","_id","nick","url","downurl","window","location","host","createTime","Date","toLocaleString","urls","label","value","name","layout","onFinish","values","AgentAddApi","resetFields","rules","required","message","prefix","placeholder","style","width","options","shouldUpdate","type","htmlType","disabled","isFieldsTouched","getFieldsError","filter","errors","length","title","dataIndex","align","render","_","text","marginRight","onClick","setFieldsValue","onEdit","danger","params","id","AgentDelApi","newDataSource","item","onDel","placement","onClose","AgentEditApi","display","http","axios","baseURL","process","interceptors","request","use","config","localStorage","__web_token","headers","Authorization","err","Promise","reject","response","status","removeItem","console","log","pathname","indexOf","LoginApi","model","RegisterApi","UserApi","UserEditApi","UrlApi","UrlAddApi","UrlEditApi","UrlDelApi","PromotionApi","PromotionEditApi","StatsApi","HomeApi","CommonImgApi","CommonDataApi"],"sourceRoot":""}